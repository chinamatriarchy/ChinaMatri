<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥³ç¥è°±ç³» - æ¯æƒæ–‡åŒ–çŸ¥è¯†åº“</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.net.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
    <script src="src/js/sanity-unified.js"></script>
</head>
<body class="bg-gray-900 text-gray-100">
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <nav class="fixed w-full bg-gray-900/80 backdrop-blur-sm z-50 border-b border-purple-500/20">
        <div class="container mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <h1 class="text-2xl font-bold bg-gradient-to-r from-purple-400 to-pink-600 bg-clip-text text-transparent">
                    æ¯æƒæ–‡åŒ–çŸ¥è¯†åº“
                </h1>
                <div class="flex gap-4">
                    <a href="index.html" class="hover:text-purple-400">é¦–é¡µ</a>
                    <a href="map.html" class="hover:text-purple-400">é—å€åœ°å›¾</a>
                    <a href="goddess.html" class="text-purple-400">å¥³ç¥è°±ç³»</a>
                    <a href="scholars.html" class="hover:text-purple-400">å­¦è€…</a>
                    <a href="works.html" class="hover:text-purple-400">è®ºè‘—</a>
                    <a href="communities.html" class="hover:text-purple-400">ç°å­˜æ°æ—</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Vanta èƒŒæ™¯ -->
    <div id="vanta-bg" class="fixed inset-0 -z-10"></div>

    <!-- ä¸»å†…å®¹ -->
    <main class="container mx-auto px-6 pt-24 pb-12">
        <!-- é¡µé¢æ ‡é¢˜ -->
        <div class="text-center mb-12">
            <h2 class="text-4xl font-bold mb-4 bg-gradient-to-r from-purple-400 to-pink-600 bg-clip-text text-transparent">
                â­ å¥³ç¥è°±ç³»
            </h2>
            <p class="text-gray-400">ä»ç»Ÿä¸€æ•°æ®æ¨¡å‹åŠ è½½ - æŒ‰åˆ†ç±»è‡ªåŠ¨å±•ç¤º</p>
        </div>

        <!-- åˆ†ç±»ç­›é€‰ -->
        <div class="flex justify-center gap-3 mb-8 flex-wrap">
            <button onclick="filterGoddesses('all')" class="filter-btn active px-6 py-2 rounded-full bg-purple-500/20 hover:bg-purple-500/40 transition border border-purple-500/40">
                å…¨éƒ¨
            </button>
            <button onclick="filterGoddesses('creation')" class="filter-btn px-6 py-2 rounded-full bg-purple-500/20 hover:bg-purple-500/40 transition border border-purple-500/40">
                åˆ›ä¸–å¥³ç¥
            </button>
            <button onclick="filterGoddesses('nature')" class="filter-btn px-6 py-2 rounded-full bg-purple-500/20 hover:bg-purple-500/40 transition border border-purple-500/40">
                è‡ªç„¶å¥³ç¥
            </button>
            <button onclick="filterGoddesses('culture')" class="filter-btn px-6 py-2 rounded-full bg-purple-500/20 hover:bg-purple-500/40 transition border border-purple-500/40">
                æ–‡åŒ–å¥³ç¥
            </button>
        </div>

        <!-- å†…å®¹ç½‘æ ¼ -->
        <div id="goddess-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- åŠ è½½æç¤º -->
            <div class="col-span-full text-center py-12">
                <div class="animate-spin w-12 h-12 border-4 border-purple-500 border-t-transparent rounded-full mx-auto mb-4"></div>
                <p class="text-gray-400">æ­£åœ¨ä» CMS åŠ è½½æ•°æ®...</p>
            </div>
        </div>

        <!-- ç»Ÿè®¡ä¿¡æ¯ -->
        <div class="mt-12 text-center">
            <div class="inline-block bg-gray-800/50 backdrop-blur-sm rounded-lg px-6 py-4 border border-purple-500/20">
                <p class="text-gray-400">
                    å…±æœ‰ <span id="total-count" class="text-purple-400 font-bold">0</span> ä½å¥³ç¥
                    Â· æ•°æ®æ¥æºï¼šç»Ÿä¸€å†…å®¹æ¨¡å‹ï¼ˆcategory: goddessï¼‰
                </p>
            </div>
        </div>
    </main>

    <script>
        // Vanta èƒŒæ™¯
        VANTA.NET({
            el: "#vanta-bg",
            mouseControls: true,
            touchControls: true,
            gyroControls: false,
            minHeight: 200.00,
            minWidth: 200.00,
            scale: 1.00,
            scaleMobile: 1.00,
            color: 0x9333ea,
            backgroundColor: 0x111827
        });

        // å¥³ç¥æ•°æ®
        let allGoddesses = [];

        // åŠ è½½å¥³ç¥æ•°æ®
        async function loadGoddesses() {
            try {
                const goddesses = await SanityAPI.getGoddesses();
                allGoddesses = goddesses;
                renderGoddesses(goddesses);
                document.getElementById('total-count').textContent = goddesses.length;
                
                // å¦‚æœæ²¡æœ‰æ•°æ®ï¼Œæ˜¾ç¤ºç¤ºä¾‹
                if (goddesses.length === 0) {
                    showSampleData();
                }
            } catch (error) {
                console.error('Error loading goddesses:', error);
                showSampleData();
            }
        }

        // æ¸²æŸ“å¥³ç¥å¡ç‰‡
        function renderGoddesses(goddesses) {
            const grid = document.getElementById('goddess-grid');
            
            if (goddesses.length === 0) {
                grid.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <p class="text-gray-400 text-lg">æš‚æ— æ•°æ®</p>
                        <p class="text-gray-500 text-sm mt-2">è¯·åœ¨ Sanity Studio ä¸­æ·»åŠ  category ä¸º "goddess" çš„å†…å®¹</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = goddesses.map(goddess => `
                <div class="goddess-card bg-gray-800/50 backdrop-blur-sm rounded-lg overflow-hidden border border-purple-500/20 hover:border-purple-500/50 transition hover:scale-105 cursor-pointer" data-id="${goddess._id}">
                    ${goddess.image ? `
                        <img src="${SanityAPI.getImageUrl(goddess.image, 600)}" 
                             alt="${goddess.title}" 
                             class="w-full h-48 object-cover">
                    ` : `
                        <div class="w-full h-48 bg-gradient-to-br from-purple-500/20 to-pink-500/20 flex items-center justify-center">
                            <span class="text-6xl">â­</span>
                        </div>
                    `}
                    <div class="p-6">
                        <div class="flex items-start justify-between mb-2">
                            <h3 class="text-xl font-bold text-purple-300">${goddess.title}</h3>
                            ${goddess.categoryName ? `
                                <span class="text-xs px-2 py-1 bg-purple-500/20 rounded-full text-purple-300">${goddess.categoryName}</span>
                            ` : ''}
                        </div>
                        ${goddess.subtitle ? `
                            <p class="text-gray-400 text-sm mb-3">${goddess.subtitle}</p>
                        ` : ''}
                        ${goddess.summary ? `
                            <p class="text-gray-300 text-sm mb-4 line-clamp-3">${goddess.summary}</p>
                        ` : ''}
                        ${goddess.relatedCultures && goddess.relatedCultures.length > 0 ? `
                            <div class="flex flex-wrap gap-2 mt-3">
                                ${goddess.relatedCultures.slice(0, 3).map(tag => `
                                    <span class="text-xs px-2 py-1 bg-gray-700 rounded text-gray-300">${tag}</span>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                </div>
            `).join('');

            feather.replace();
        }

        // ç­›é€‰åŠŸèƒ½
        function filterGoddesses(subcategory) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-purple-500', 'text-white');
            });
            event.target.classList.add('active', 'bg-purple-500', 'text-white');

            // ç­›é€‰æ•°æ®
            let filtered = allGoddesses;
            if (subcategory !== 'all') {
                filtered = allGoddesses.filter(g => g.category === subcategory);
            }
            
            renderGoddesses(filtered);
        }

        // æ˜¾ç¤ºç¤ºä¾‹æ•°æ®ï¼ˆå¦‚æœ CMS ä¸­æ²¡æœ‰æ•°æ®ï¼‰
        function showSampleData() {
            const grid = document.getElementById('goddess-grid');
            grid.innerHTML = `
                <div class="col-span-full bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-6">
                    <h3 class="text-xl font-bold text-yellow-400 mb-3">ğŸ’¡ è¿™æ˜¯ç»Ÿä¸€æ•°æ®æ¨¡å‹ç¤ºä¾‹</h3>
                    <p class="text-gray-300 mb-4">ç›®å‰ CMS ä¸­è¿˜æ²¡æœ‰æ•°æ®ã€‚è¯·åœ¨ Sanity Studio ä¸­ï¼š</p>
                    <ol class="list-decimal list-inside text-gray-400 space-y-2 mb-4">
                        <li>åˆ›å»ºæ–°å†…å®¹ï¼ˆContent â†’ Entry â†’ Createï¼‰</li>
                        <li>é€‰æ‹© <strong class="text-purple-400">åˆ†ç±» = ğŸ—ºï¸ å¥³ç¥</strong></li>
                        <li>å¡«å†™æ ‡é¢˜ã€å­åˆ†ç±»ï¼ˆåˆ›ä¸–å¥³ç¥/è‡ªç„¶å¥³ç¥ç­‰ï¼‰</li>
                        <li>å…¶ä»–å­—æ®µå¯é€‰å¡«å†™</li>
                        <li>å‘å¸ƒåå³å¯åœ¨æ­¤é¡µé¢çœ‹åˆ°</li>
                    </ol>
                    <p class="text-gray-400 text-sm">
                        âœ¨ ä¼˜åŠ¿ï¼šæ‰€æœ‰æ•°æ®ç”¨åŒä¸€ä¸ªæ¨¡å‹ï¼Œåªéœ€é€‰æ‹©ä¸åŒçš„ category å³å¯è‡ªåŠ¨æ˜¾ç¤ºåœ¨å¯¹åº”é¡µé¢ï¼
                    </p>
                </div>
            `;
            document.getElementById('total-count').textContent = '0';
        }

        // é¡µé¢åŠ è½½æ—¶è·å–æ•°æ®
        loadGoddesses();
    </script>
</body>
</html>





