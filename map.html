<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>母系考古地图 - MatriArchive</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap');
        body {
            font-family: 'Noto Serif SC', serif;
        }
        .nav-link:hover {
            text-decoration: underline;
            text-decoration-thickness: 2px;
        }
        #map {
            height: 600px;
            border-radius: 8px;
        }
        .legend {
            background: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 8px;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900">
    
    <header>
        <nav class="bg-white shadow-sm">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between h-16">
                    <div class="flex items-center">
                        <a href="index.html" class="flex items-center">
                            <i data-feather="layers" class="text-purple-600 mr-2"></i>
                            <span class="text-xl font-bold text-purple-800">MatriArchive</span>
                        </a>
                    </div>
                    <div class="hidden md:flex items-center space-x-8">
                        <a href="index.html#definition" class="nav-link text-gray-700 hover:text-purple-600">定义</a>
                        <a href="timeline.html" class="nav-link text-gray-700 hover:text-purple-600">时间线</a>
                        <a href="map.html" class="nav-link text-purple-600 font-semibold">考古地图</a>
                        <a href="goddess.html" class="nav-link text-gray-700 hover:text-purple-600">女神谱系</a>
                        <a href="communities.html" class="nav-link text-gray-700 hover:text-purple-600">现存氏族</a>
                        <a href="works.html" class="nav-link text-gray-700 hover:text-purple-600">相关论著</a>
                        <a href="scholars.html" class="nav-link text-gray-700 hover:text-purple-600">学者名录</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <!-- Page Header -->
        <section class="bg-gradient-to-r from-purple-600 to-blue-500 text-white py-12">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <h1 class="text-4xl font-bold mb-4">母系文化考古地图</h1>
                <p class="text-xl">探索中国境内主要母系文化遗址的地理分布</p>
            </div>
        </section>

        <!-- Filter Controls -->
        <section class="bg-white py-6 shadow-sm">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex flex-wrap gap-4 items-center">
                    <span class="font-semibold">筛选时期：</span>
                    <button onclick="filterPeriod('all')" class="filter-btn px-4 py-2 rounded-full bg-purple-600 text-white hover:bg-purple-700 transition">
                        全部
                    </button>
                    <button onclick="filterPeriod('yangshao')" class="filter-btn px-4 py-2 rounded-full bg-gray-200 hover:bg-gray-300 transition">
                        仰韶文化
                    </button>
                    <button onclick="filterPeriod('hemudu')" class="filter-btn px-4 py-2 rounded-full bg-gray-200 hover:bg-gray-300 transition">
                        河姆渡文化
                    </button>
                    <button onclick="filterPeriod('hongshan')" class="filter-btn px-4 py-2 rounded-full bg-gray-200 hover:bg-gray-300 transition">
                        红山文化
                    </button>
                    <button onclick="filterPeriod('dawenkou')" class="filter-btn px-4 py-2 rounded-full bg-gray-200 hover:bg-gray-300 transition">
                        大汶口文化
                    </button>
                </div>
            </div>
        </section>

        <!-- Map Section -->
        <section class="py-8">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <div id="map"></div>
                </div>
            </div>
        </section>

        <!-- Sites List -->
        <section class="py-8">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-3xl font-bold mb-8">重要遗址详情</h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="sites-list">
                    <!-- Sites will be dynamically loaded here -->
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-gray-800 text-gray-300 py-12 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-white text-lg font-semibold mb-4">MatriArchive</h3>
                    <p class="mb-4">致力于中国母权/母系社会研究的学术数据库</p>
                </div>
                <div>
                    <h3 class="text-white text-lg font-semibold mb-4">快速链接</h3>
                    <ul class="space-y-2">
                        <li><a href="index.html#definition" class="hover:text-white">母权定义</a></li>
                        <li><a href="timeline.html" class="hover:text-white">时间线</a></li>
                        <li><a href="goddess.html" class="hover:text-white">女神谱系</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-white text-lg font-semibold mb-4">更多资源</h3>
                    <ul class="space-y-2">
                        <li><a href="communities.html" class="hover:text-white">现存氏族</a></li>
                        <li><a href="works.html" class="hover:text-white">相关论著</a></li>
                        <li><a href="scholars.html" class="hover:text-white">学者名录</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-white text-lg font-semibold mb-4">联系我们</h3>
                    <ul class="space-y-2">
                        <li class="flex items-center">
                            <i data-feather="mail" class="mr-2"></i>
                            <span>contact@matriarchive.org</span>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 text-center">
                <p>© 2023 MatriArchive. 保留所有权利。</p>
            </div>
        </div>
    </footer>

    <script>
        // 考古遗址数据（实际项目中应该从JSON文件或API加载）
        const archaeologicalSites = [
            {
                name: "半坡遗址",
                period: "yangshao",
                periodName: "仰韶文化",
                lat: 34.27,
                lng: 109.00,
                date: "约公元前4800-3600年",
                description: "位于陕西西安，是仰韶文化的典型遗址，发现了大量母系氏族社会的房屋遗迹和陶器。",
                findings: "彩陶、石器、房屋遗址",
                image: "http://static.photos/travel/400x300/1"
            },
            {
                name: "姜寨遗址",
                period: "yangshao",
                periodName: "仰韶文化",
                lat: 34.53,
                lng: 109.35,
                date: "约公元前5000-3000年",
                description: "位于陕西临潼，保存完好的母系氏族村落遗址，展现了母系社会的聚落形态。",
                findings: "环壕聚落、彩陶、墓葬",
                image: "http://static.photos/travel/400x300/2"
            },
            {
                name: "河姆渡遗址",
                period: "hemudu",
                periodName: "河姆渡文化",
                lat: 30.03,
                lng: 121.35,
                date: "约公元前5500-4500年",
                description: "位于浙江余姚，长江下游新石器文化代表，发现了干栏式建筑和稻作农业证据。",
                findings: "干栏建筑、骨耜、陶器、稻谷遗存",
                image: "http://static.photos/travel/400x300/3"
            },
            {
                name: "田螺山遗址",
                period: "hemudu",
                periodName: "河姆渡文化",
                lat: 30.05,
                lng: 121.40,
                date: "约公元前5000-4000年",
                description: "位于浙江余姚，与河姆渡文化同期，保存了丰富的有机质遗存。",
                findings: "木构建筑、漆器、编织物",
                image: "http://static.photos/travel/400x300/4"
            },
            {
                name: "牛河梁遗址",
                period: "hongshan",
                periodName: "红山文化",
                lat: 41.30,
                lng: 119.67,
                date: "约公元前3500-3000年",
                description: "位于辽宁凌源，发现了著名的女神庙和祭坛，是红山文化的礼制中心。",
                findings: "女神庙、玉器、积石冢",
                image: "http://static.photos/travel/400x300/5"
            },
            {
                name: "东山嘴遗址",
                period: "hongshan",
                periodName: "红山文化",
                lat: 41.58,
                lng: 120.10,
                date: "约公元前5000-4000年",
                description: "位于辽宁喀喇沁，发现了女性陶塑和祭祀遗存，反映女神崇拜。",
                findings: "女性陶塑像、祭祀遗迹",
                image: "http://static.photos/travel/400x300/6"
            },
            {
                name: "大汶口遗址",
                period: "dawenkou",
                periodName: "大汶口文化",
                lat: 36.15,
                lng: 117.13,
                date: "约公元前4300-2500年",
                description: "位于山东泰安，黄河下游新石器文化，墓葬中发现女性地位较高的证据。",
                findings: "彩陶、玉器、随葬品丰富的女性墓葬",
                image: "http://static.photos/travel/400x300/7"
            },
            {
                name: "大地湾遗址",
                period: "yangshao",
                periodName: "仰韶文化",
                lat: 34.95,
                lng: 105.90,
                date: "约公元前6000-3000年",
                description: "位于甘肃秦安，是西北地区重要的新石器时代遗址，发现了大型房址和彩陶。",
                findings: "大型房址F901、彩陶、地画",
                image: "http://static.photos/travel/400x300/8"
            }
        ];

        // 时期颜色映射
        const periodColors = {
            'yangshao': '#9333ea',  // 紫色
            'hemudu': '#3b82f6',    // 蓝色
            'hongshan': '#ec4899',  // 粉色
            'dawenkou': '#f59e0b'   // 橙色
        };

        // 初始化地图
        let map;
        let markers = [];

        function initMap() {
            // 创建地图，中心设置在中国
            map = L.map('map').setView([35.0, 110.0], 5);

            // 使用高德地图（在中国大陆访问更快更稳定）
            const gdNormalLayer = L.tileLayer('https://webrd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}', {
                subdomains: ['1', '2', '3', '4'],
                attribution: '© 高德地图',
                maxZoom: 18
            });

            // 备用：OpenStreetMap
            const osmLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap',
                maxZoom: 18
            });

            // 默认使用高德地图
            gdNormalLayer.addTo(map);

            // 如果加载失败，切换到 OpenStreetMap
            gdNormalLayer.on('tileerror', function() {
                console.warn('⚠️ 高德地图加载失败，切换到 OpenStreetMap');
                map.removeLayer(gdNormalLayer);
                osmLayer.addTo(map);
            });

            // 添加图层切换控制
            const baseMaps = {
                "高德地图": gdNormalLayer,
                "OpenStreetMap": osmLayer
            };
            L.control.layers(baseMaps).addTo(map);

            // 添加图例
            addLegend();

            // 添加所有标记
            addMarkers(archaeologicalSites);

            // 渲染遗址列表
            renderSitesList(archaeologicalSites);
        }

        function addLegend() {
            const legend = L.control({position: 'bottomright'});
            
            legend.onAdd = function(map) {
                const div = L.DomUtil.create('div', 'legend');
                div.innerHTML = `
                    <h4 class="font-semibold mb-2">文化时期</h4>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: ${periodColors.yangshao}"></div>
                        <span class="text-sm">仰韶文化</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: ${periodColors.hemudu}"></div>
                        <span class="text-sm">河姆渡文化</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: ${periodColors.hongshan}"></div>
                        <span class="text-sm">红山文化</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: ${periodColors.dawenkou}"></div>
                        <span class="text-sm">大汶口文化</span>
                    </div>
                `;
                return div;
            };
            
            legend.addTo(map);
        }

        function addMarkers(sites) {
            // 清除现有标记
            markers.forEach(marker => map.removeLayer(marker));
            markers = [];

            // 添加新标记
            sites.forEach(site => {
                const marker = L.circleMarker([site.lat, site.lng], {
                    radius: 8,
                    fillColor: periodColors[site.period],
                    color: '#fff',
                    weight: 2,
                    opacity: 1,
                    fillOpacity: 0.8
                }).addTo(map);

                // 添加弹出窗口
                marker.bindPopup(`
                    <div class="p-2">
                        <h3 class="font-bold text-lg text-purple-700">${site.name}</h3>
                        <p class="text-sm text-gray-600">${site.periodName}</p>
                        <p class="text-sm mt-1">${site.date}</p>
                        <p class="text-sm mt-2">${site.description}</p>
                    </div>
                `);

                markers.push(marker);
            });
        }

        function renderSitesList(sites) {
            const container = document.getElementById('sites-list');
            container.innerHTML = sites.map(site => `
                <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition">
                    <img src="${site.image}" alt="${site.name}" class="w-full h-48 object-cover">
                    <div class="p-6">
                        <div class="flex items-center mb-2">
                            <div class="w-4 h-4 rounded-full mr-2" style="background-color: ${periodColors[site.period]}"></div>
                            <span class="text-sm text-gray-600">${site.periodName}</span>
                        </div>
                        <h3 class="text-xl font-bold text-purple-700 mb-2">${site.name}</h3>
                        <p class="text-sm text-gray-600 mb-3">${site.date}</p>
                        <p class="text-gray-700 mb-4">${site.description}</p>
                        <div class="border-t pt-4">
                            <p class="text-sm font-semibold text-gray-700">主要发现：</p>
                            <p class="text-sm text-gray-600">${site.findings}</p>
                        </div>
                        <button onclick="focusOnSite(${site.lat}, ${site.lng})" 
                                class="mt-4 text-purple-600 hover:text-purple-800 text-sm font-medium inline-flex items-center">
                            在地图上查看
                            <i data-feather="map-pin" class="ml-1 w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            `).join('');
            
            // 重新初始化图标
            feather.replace();
        }

        function filterPeriod(period) {
            // 更新按钮样式
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('bg-purple-600', 'text-white');
                btn.classList.add('bg-gray-200');
            });
            event.target.classList.remove('bg-gray-200');
            event.target.classList.add('bg-purple-600', 'text-white');

            // 筛选数据
            const filteredSites = period === 'all' 
                ? archaeologicalSites 
                : archaeologicalSites.filter(site => site.period === period);

            // 更新地图和列表
            addMarkers(filteredSites);
            renderSitesList(filteredSites);
        }

        function focusOnSite(lat, lng) {
            map.setView([lat, lng], 10);
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            initMap();
            feather.replace();
        });
    </script>
</body>
</html>

